# Sky Shop Demo

这是一个用于演示 Sky Monitor SDK 功能的电商购物车 Demo 应用。

## 技术栈

-   **框架**: React 19.2.0 + TypeScript 5.9.3
-   **构建工具**: Vite 7.2.2
-   **UI 库**: Shadcn UI + Tailwind CSS 3.4.14
-   **状态管理**: Zustand
-   **路由**: React Router DOM 6.27.0
-   **SDK**: @sky-monitor/monitor-sdk-browser

## 项目结构

```
demos/shop-demo/
├── src/
│   ├── api/                 # API 接口
│   │   ├── products.ts          # 商品 API
│   │   └── orders.ts            # 订单 API
│   ├── components/          # 组件
│   │   ├── cart/                # 购物车组件
│   │   ├── layout/              # 布局组件
│   │   ├── product/             # 商品组件
│   │   ├── sdk-debug/           # SDK 调试面板
│   │   └── ui/                  # UI 基础组件
│   ├── hooks/               # 自定义 Hooks
│   ├── lib/                 # 工具函数
│   ├── mocks/               # Mock 数据
│   ├── pages/               # 页面组件
│   ├── store/               # 状态管理
│   ├── App.tsx              # 应用入口
│   └── main.tsx             # 主入口
├── package.json
├── vite.config.ts
├── tailwind.config.js
└── tsconfig.json
```

## 功能特性

### 业务功能

-   商品列表展示和分类筛选
-   商品详情查看
-   购物车管理 (添加、删除、修改数量)
-   订单结算和支付流程 (30% 失败率用于演示错误监控)
-   个人中心和订单历史

### 监控功能

-   错误监控 (支持采样率配置)
-   性能监控 (支持采样率配置)
-   Session Replay (支持采样率配置)
-   SDK 调试面板 (可实时调整配置)
-   错误模拟器 (JS 错误、Promise 拒绝、类型错误、网络错误)
-   性能测试工具 (长任务、慢速 API)

### UI/UX 特性

-   响应式设计,支持移动端和桌面端
-   骨架屏加载效果
-   平滑的过渡动画
-   卡片悬停效果
-   Toast 通知提示

## 快速开始

### 1. 安装依赖

```bash
cd demos/shop-demo
pnpm install
```

### 2. 启动开发服务器

```bash
pnpm dev
```

应用将在 `http://localhost:5433` 启动

### 3. 开始使用

1. 打开浏览器访问 `http://localhost:5433`
2. 浏览商品列表,点击商品查看详情
3. 添加商品到购物车
4. 进入购物车页面,修改数量或删除商品
5. 点击结算,填写收货信息
6. 提交订单并支付 (30% 概率失败,用于演示错误监控)
7. 点击右上角设置图标打开 SDK 调试面板
8. 调整采样率和监控开关,查看效果

## 监控场景说明

### 1. 错误监控

-   支付失败场景: 30% 的支付请求会失败,触发错误上报
-   商品加载失败: 部分商品图片加载失败

### 2. 性能监控

-   页面加载性能
-   API 请求性能
-   路由切换性能

### 3. 采样率演示

-   通过 SDK 调试面板可以实时调整采样率
-   采样率范围: 0% - 100%
-   配置会持久化到本地存储

## SDK 调试面板使用说明

1. 点击页面右上角的设置图标打开 SDK 调试面板
2. 可以开关各项监控功能
3. 可以调整各项监控的采样率 (0-100%)
4. 可以触发各种错误进行测试:
    - JS 错误: 抛出标准 JavaScript 错误
    - Promise 拒绝: 触发未捕获的 Promise 拒绝
    - 类型错误: 触发 TypeError
    - 网络错误: 触发网络请求失败
5. 可以执行性能测试:
    - 长任务: 执行耗时的计算任务
    - 慢速 API: 模拟 3 秒延迟的 API 调用
6. 配置会实时生效并保存到本地存储

## 设计风格

采用 Amazon 风格的简洁设计:

-   主色调: 橙色 (#FF9900)
-   简洁的卡片式布局
-   清晰的信息层级
-   响应式设计

## 开发命令

```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 构建生产版本
pnpm build

# 预览生产构建
pnpm preview
```

## 注意事项

1. 确保 DSN 服务器正在运行
2. 打开浏览器控制台查看详细日志
3. 某些测试需要网络连接（如 Fetch 测试）
4. Session Replay 在错误触发后 10 秒上报
5. 性能采样率为 30%，部分性能事件可能不会上报

## 故障排查

### SDK 未初始化

-   检查 DSN 服务器是否运行
-   查看控制台错误信息
-   确认 DSN 地址正确

### 测试按钮无响应

-   打开浏览器控制台查看错误
-   检查网络请求是否成功
-   确认 SDK 已正确初始化

### 数据未上报

-   检查 DSN 服务器日志
-   确认采样率配置
-   查看批量上报配置（5 秒刷新间隔）
